---
import Layout from '../layouts/Layout.astro';
import CodeExamples from '../components/CodeExamples';
import LiveStats from '../components/LiveStats';
import { EXAMPLES } from '../utils/clyp-highlighter';

// Load banner data
let banner = null;
try {
  const bannerData = await fetch(new URL('/banner.json', Astro.url.origin));
  if (bannerData.ok) {
    const banners = await bannerData.json();
    if (banners && banners.length > 0) {
      // Alternate based on current time (30s interval)
      const idx = Math.floor(Date.now() / 30000) % banners.length;
      banner = banners[idx];
    }
  }
} catch (e) {
  // Banner file not found or invalid, use null
}
---

<Layout title="Clyp - Modern Programming Language" banner={banner}>
  <!-- Hero Section -->
  <section class="hero">
    <div class="hero-container">
      <div class="hero-content">
        <div class="hero-text">
          <h1 class="hero-title">
            <span class="gradient-text">CLYP</span>
            <br><span class="hero-subtitle-inline">The Future of Code</span>
          </h1>
          <p class="hero-subtitle">
            🚀 A revolutionary programming language that transforms the way you think about code. 
            Clean syntax, lightning-fast performance, and seamless Python interoperability.
          </p>
          <div class="hero-stats">
            <div class="stat-item">
              <span class="stat-number">10x</span>
              <span class="stat-label">Faster Development</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">100%</span>
              <span class="stat-label">Python Compatible</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">∞</span>
              <span class="stat-label">Possibilities</span>
            </div>
          </div>
          <div class="hero-actions">
            <a href="#get-started" class="btn btn-primary">
              🔥 START CODING NOW
            </a>
            <a href="/examples" class="btn btn-secondary">
              💎 EXPLORE EXAMPLES
            </a>
          </div>
        </div>
        <div class="hero-code">
          <div class="code-window hero-code-window">
            <div class="code-header">
              <div class="code-dots">
                <span class="dot red"></span>
                <span class="dot yellow"></span>
                <span class="dot green"></span>
              </div>
              <span class="code-title">✨ hello_world.clyp</span>
            </div>
            <div class="code-content">
              <Fragment set:html={EXAMPLES.hello_world.highlighted_code} />
            </div>
            <div class="code-footer">
              <div class="power-indicator">
                <div class="power-bar"></div>
                <span>POWERED BY CLYP</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Floating Elements -->
      <div class="floating-elements">
        <div class="floating-element" style="top: 20%; left: 10%; animation-delay: 0s;">💻</div>
        <div class="floating-element" style="top: 60%; right: 15%; animation-delay: 1s;">⚡</div>
        <div class="floating-element" style="top: 80%; left: 20%; animation-delay: 2s;">🚀</div>
        <div class="floating-element" style="top: 30%; right: 25%; animation-delay: 1.5s;">💎</div>
      </div>
      
      <!-- TinyLaunch badge -->
      <div class="hero-badge">
        <a href="https://tinylaunch.com" target="_blank" rel="noopener noreferrer" aria-label="TinyLaunch">
          <img src="https://tinylaunch.com/tinylaunch_badge_launching_soon.svg" alt="TinyLaunch Badge" style="width:202px; height:auto; filter: drop-shadow(0 0 20px rgba(255, 45, 146, 0.5));" />
        </a>
      </div>
    </div>
  </section>

  <!-- Live Stats Section -->
  <LiveStats client:load />

  <!-- Features Section -->
  <section class="features">
    <div class="features-container">
      <h2 class="section-title">🔥 WHY CLYP DOMINATES</h2>
      <div class="features-grid">
        <div class="feature-card">
          <div class="feature-icon">🎯</div>
          <h3>LASER-FOCUSED TYPING</h3>
          <p>Crystal-clear variable declarations with bulletproof type safety. Catch errors before they catch you.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">⚡</div>
          <h3>LIGHTNING SYNTAX</h3>
          <p>C-like syntax that feels natural and powerful. Write less, achieve more, dominate your deadlines.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">🐍</div>
          <h3>PYTHON SUPERPOWER</h3>
          <p>Instant access to Python's entire ecosystem. All your favorite libraries, turbocharged with Clyp.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">📚</div>
          <h3>BATTLE-TESTED LIBRARY</h3>
          <p>Built-in functions for everything you need. File I/O, HTTP, data manipulation - it's all here.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">🔥</div>
          <h3>PIPELINE MASTERY</h3>
          <p>Functional programming paradise with the |> operator. Transform data like a wizard.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">🚀</div>
          <h3>NEXT-GEN FEATURES</h3>
          <p>Classes, loops, conditionals, and advanced constructs that make complex problems simple.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Code Examples Section -->
  <CodeExamples client:load />

  <!-- Installation Section -->
  <section id="get-started" class="installation">
    <div class="install-container">
      <h2 class="section-title">⚡ GET CLYP NOW</h2>
      <div class="install-columns">
        <!-- Windows Column -->
        <div class="install-col windows-col">
          <div class="install-icon">🪟</div>
          <h3>WINDOWS POWER</h3>
          <p>Unleash Clyp on Windows 10/11 with our blazing-fast installer.</p>
          <a href="https://github.com/clyplang/clypinstaller/releases/latest/download/install.exe" class="btn btn-primary install-btn" download>
            🚀 DOWNLOAD INSTALLER
          </a>
          <div class="install-note">
            <span>One-click installation. Ready in seconds.</span>
          </div>
        </div>
        
        <!-- Other Platforms Column -->
        <div class="install-col universal-col">
          <div class="install-icon">🐧🍎💻</div>
          <h3>UNIVERSAL POWER</h3>
          <p>Join the revolution on Linux, macOS, or WSL:</p>
          <div class="code-block install-code">
            <code id="pip-install-cmd">pip install clyp</code>
            <button class="copy-btn" onclick="copyToClipboard('pip install clyp')">📋</button>
          </div>
          <div class="install-note">
            <span>Requires Python 3.8+ and pip. Ready to rock.</span>
          </div>
        </div>
      </div>
      <div class="install-cta">
        <p class="cta-text">Ready to revolutionize your coding? 🔥</p>
        <a href="/examples" class="btn btn-primary cta-btn">💎 EXPLORE THE POWER</a>
      </div>
    </div>
  </section>
</Layout>

<style>
.hero-subtitle-inline {
  font-size: 2.5rem;
  font-weight: 800;
  background: var(--gradient-secondary);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.hero-stats {
  display: flex;
  gap: var(--spacing-xl);
  margin: var(--spacing-2xl) 0;
}

.stat-item {
  text-align: center;
}

.stat-number {
  display: block;
  font-size: 2.5rem;
  font-weight: 900;
  color: var(--primary-color);
  text-shadow: 0 0 20px currentColor;
}

.stat-label {
  font-size: 0.9rem;
  color: var(--text-secondary);
  text-transform: uppercase;
  font-weight: 600;
}

.hero-code-window {
  position: relative;
  transform: perspective(1000px) rotateY(-5deg) rotateX(5deg);
}

.code-footer {
  background: var(--code-header-bg);
  padding: var(--spacing-md) var(--spacing-lg);
  border-top: 1px solid var(--code-border);
}

.power-indicator {
  display: flex;
  align-items: center;
  gap: var(--spacing-md);
}

.power-bar {
  width: 100px;
  height: 4px;
  background: var(--gradient-primary);
  border-radius: 2px;
  animation: powerPulse 2s ease-in-out infinite;
}

@keyframes powerPulse {
  0%, 100% { opacity: 0.6; }
  50% { opacity: 1; }
}

.power-indicator span {
  font-size: 0.8rem;
  font-weight: 600;
  color: var(--text-accent);
  text-transform: uppercase;
  letter-spacing: 1px;
}

.floating-elements {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
}

.floating-element {
  position: absolute;
  font-size: 2rem;
  animation: float 6s ease-in-out infinite;
  opacity: 0.6;
}

@keyframes float {
  0%, 100% { transform: translateY(0) rotate(0deg); }
  50% { transform: translateY(-20px) rotate(10deg); }
}

.install-columns {
  display: flex;
  gap: var(--spacing-2xl);
  justify-content: center;
  margin: var(--spacing-4xl) 0;
}

.install-col {
  flex: 1;
  max-width: 400px;
  background: var(--bg-card);
  border-radius: var(--radius-2xl);
  padding: var(--spacing-2xl);
  text-align: center;
  border: 2px solid var(--border-color);
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.install-col::before {
  content: '';
  position: absolute;
  inset: 0;
  background: var(--gradient-primary);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.install-col:hover {
  transform: translateY(-5px);
  border-color: var(--primary-color);
  box-shadow: var(--glow-primary);
}

.install-col:hover::before {
  opacity: 0.05;
}

.install-col > * {
  position: relative;
  z-index: 1;
}

.install-icon {
  font-size: 3rem;
  margin-bottom: var(--spacing-lg);
}

.install-col h3 {
  font-size: 1.3rem;
  font-weight: 700;
  margin-bottom: var(--spacing-md);
  background: var(--gradient-accent);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.install-btn {
  margin: var(--spacing-lg) 0;
}

.install-code {
  background: var(--code-bg);
  border: 2px solid var(--code-border);
  border-radius: var(--radius-lg);
  padding: var(--spacing-md);
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin: var(--spacing-lg) 0;
}

.install-code code {
  font-family: var(--font-mono);
  color: var(--text-accent);
  font-weight: 600;
}

.copy-btn {
  background: var(--primary-color);
  border: none;
  border-radius: var(--radius-md);
  padding: var(--spacing-xs) var(--spacing-sm);
  cursor: pointer;
  transition: all 0.2s ease;
}

.copy-btn:hover {
  transform: scale(1.1);
}

.install-note {
  font-size: 0.9rem;
  color: var(--text-light);
  margin-top: var(--spacing-md);
}

.cta-text {
  font-size: 1.3rem;
  font-weight: 600;
  margin-bottom: var(--spacing-lg);
  background: var(--gradient-primary);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.cta-btn {
  font-size: 1.2rem;
  padding: var(--spacing-lg) var(--spacing-2xl);
}

@media (max-width: 768px) {
  .hero-stats {
    flex-direction: column;
    gap: var(--spacing-md);
  }
  
  .install-columns {
    flex-direction: column;
    gap: var(--spacing-xl);
  }
  
  .floating-elements {
    display: none;
  }
}
</style>

<script>
function copyToClipboard(text) {
  navigator.clipboard.writeText(text);
  event.target.textContent = '✅';
  setTimeout(() => {
    event.target.textContent = '📋';
  }, 2000);
}
</script>