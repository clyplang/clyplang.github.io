---
import Layout from '../layouts/Layout.astro';
import CodeExamples from '../components/CodeExamples';
import LiveStats from '../components/LiveStats';
import { EXAMPLES } from '../utils/clyp-highlighter';

// Load banner data
let banner = null;
try {
  const bannerData = await fetch(new URL('/banner.json', Astro.url.origin));
  if (bannerData.ok) {
    const banners = await bannerData.json();
    if (banners && banners.length > 0) {
      // Alternate based on current time (30s interval)
      const idx = Math.floor(Date.now() / 30000) % banners.length;
      banner = banners[idx];
    }
  }
} catch (e) {
  // Banner file not found or invalid, use null
}
---

<Layout title="Clyp - Modern Programming Language" banner={banner}>
  <!-- Hero Section -->
  <section class="hero">
    <div class="hero-container">
      <div class="hero-content">
        <div class="hero-text">
          <h1 class="hero-title">
            <span class="gradient-text">Clyp</span>
            <br>Modern Python-like Language
          </h1>
          <p class="hero-subtitle">
            A clean, expressive programming language that transpiles to Python. 
            Enjoy static-like typing, simplified syntax, and seamless Python interoperability.
          </p>
          <div class="hero-actions">
            <a href="#get-started" class="btn btn-primary">Get Started</a>
            <a href="/examples" class="btn btn-secondary">View Examples</a>
          </div>
        </div>
        <div class="hero-code">
          <div class="code-window">
            <div class="code-header">
              <div class="code-dots">
                <span class="dot red"></span>
                <span class="dot yellow"></span>
                <span class="dot green"></span>
              </div>
              <span class="code-title">hello_world.clyp</span>
            </div>
            <div class="code-content">
              <Fragment set:html={EXAMPLES.hello_world.highlighted_code} />
            </div>
          </div>
        </div>
      </div>
      <!-- Add centered TinyLaunch badge under the buttons and code example -->
      <div class="hero-badge" style="text-align:center; margin-top:1rem;">
        <a href="https://tinylaunch.com" target="_blank" rel="noopener noreferrer" aria-label="TinyLaunch">
          <img src="https://tinylaunch.com/tinylaunch_badge_launching_soon.svg" alt="TinyLaunch Badge" style="width:202px; height:auto;" />
        </a>
      </div>
    </div>
  </section>

  <!-- Live Stats Section -->
  <LiveStats client:load />

  <!-- Features Section -->
  <section class="features">
    <div class="features-container">
      <h2 class="section-title">Why Choose Clyp?</h2>
      <div class="features-grid">
        <div class="feature-card">
          <div class="feature-icon">🎯</div>
          <h3>Static-like Typing</h3>
          <p>Variables are declared with their types, providing clarity and catching errors early in development.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">✨</div>
          <h3>Clean Syntax</h3>
          <p>Uses familiar C-like syntax with {} for blocks and ; for statements, making code more readable.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">🐍</div>
          <h3>Python Interop</h3>
          <p>Seamlessly use Python libraries and functions. Clyp transpiles directly to Python code.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">📚</div>
          <h3>Rich Standard Library</h3>
          <p>Built-in functions for common tasks like file I/O, HTTP requests, and data manipulation.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">⚡</div>
          <h3>Pipeline Operator</h3>
          <p>Elegant data transformation with the pipeline operator |> for functional programming patterns.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">🔧</div>
          <h3>Modern Features</h3>
          <p>Classes, conditionals, loops, and advanced language constructs in an intuitive package.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Code Examples Section -->
  <CodeExamples client:load />

  <!-- Installation Section -->
  <section id="get-started" class="installation">
    <div class="install-container">
      <h2 class="section-title">Get Started</h2>
      <div class="install-columns" style="display: flex; gap: 2rem; justify-content: center; flex-wrap: wrap; margin: 2.5rem 0;">
        <!-- Windows Column -->
        <div class="install-col" style="flex:1 1 260px; min-width:260px; max-width:350px; background: var(--bg-card); border-radius: var(--radius-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--border-color); padding: 2rem 1.5rem; display: flex; flex-direction: column; align-items: center; margin-bottom: 1.5rem;">
          <div style="font-size:2.2rem; margin-bottom:0.7rem;">🪟</div>
          <h3 style="font-size:1.25rem; font-weight:700; margin-bottom:0.7rem; color:var(--primary-color);">Windows</h3>
          <p style="color:var(--text-secondary); text-align:center; margin-bottom:1.2rem;">Download the official installer for Windows 10/11 (64-bit).</p>
          <a style="text-align:center" href="https://github.com/clyplang/clypinstaller/releases/latest/download/install.exe" class="btn btn-primary" style="width:100%; text-align:center; font-size:1.08rem; margin-bottom:0.7rem;" download>
            Download Installer
          </a>
          <div style="font-size:0.95rem; color:var(--text-light); margin-top:0.5rem; text-align:center;">
            <span>Just run the installer and follow the prompts.</span>
          </div>
        </div>
        <!-- Other Platforms Column -->
        <div class="install-col" style="flex:1 1 260px; min-width:260px; max-width:350px; background: var(--bg-card); border-radius: var(--radius-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--border-color); padding: 2rem 1.5rem; display: flex; flex-direction: column; align-items: center; margin-bottom: 1.5rem;">
          <div style="font-size:2.2rem; margin-bottom:0.7rem;">🐧🍎💻</div>
          <h3 style="font-size:1.25rem; font-weight:700; margin-bottom:0.7rem; color:var(--primary-color);">Other Platforms</h3>
          <p style="color:var(--text-secondary); text-align:center; margin-bottom:1.2rem;">Install via <b>pip</b> on Linux, macOS, or WSL:</p>
          <div class="code-block" style="width:100%; display:flex; align-items:center; background:var(--code-bg); color:var(--code-text); border-radius:var(--radius-md); padding:0.7rem 1rem; margin-bottom:0.7rem;">
            <code id="pip-install-cmd" style="font-size:1rem; background:none; color:inherit; flex:1;">pip install clyp</code>
          </div>
          <div style="font-size:0.95rem; color:var(--text-light); margin-top:0.5rem; text-align:center;">
            <span>Requires Python 3.8+ and pip.</span>
          </div>
        </div>
      </div>
      <div class="install-cta">
        <p>Ready to dive deeper?</p>
        <a href="/examples" class="btn btn-primary">Explore Examples</a>
      </div>
    </div>
  </section>
</Layout>